# 《AI智能·学习搭子》实验/实训报告（扩充版）

> 说明：本扩充版在原报告基础上进行了系统性扩写。所有新增内容均以「【新增】」起始标注，便于人工快速定位修改处与复制整段内容。

---

## 目录（扩充版）

- 第1章 设计介绍 〔含新增：教育数字化趋势、角色画像、价值地图〕
- 第2章 设计内容
  - 2.1 需求分析 〔含新增：问卷与访谈、人物画像、场景旅程图、风险清单〕
  - 2.2 详细设计 〔含新增：域模型、数据字典、时序图、状态机、缓存与一致性策略、弹性伸缩方案〕
  - 2.3 功能实现与测试 〔含新增：测试矩阵、覆盖率报告说明、性能基准与容量规划、可用性与容错实验〕
- 第3章 设计总结 〔含新增：KPI/OKR达成度、里程碑复盘、关键教训与复用清单〕
- 第4章 合规与安全 〔新增章节〕
- 第5章 部署与运维 〔新增章节〕
- 第6章 商业模式与成本收益 〔新增章节〕
- 第7章 未来路线图与风险对策 〔新增章节〕
- 附录 〔含新增：术语表、缩略语、调研问卷原文、访谈纪要、API清单长表、数据字典长表、UML补充图集、提示词工程样例集〕

---

## 第1章 设计介绍

（以下为原文保留）

【新增】1.3 教育数字化趋势与项目定位补充

【新增】在教育部“新一代信息技术与教育深度融合”政策导向下，高校数字化从“信息化平台建设”迈向“数据驱动的精准教学与个性化学习”。大模型及智能代理的普及，使“人—机—内容—数据—场景”形成闭环：
- 学习数据贯通：学习行为、作业成绩、互动轨迹、资源偏好统一归集，形成动态学习画像。
- 智能辅助决策：对教师侧提供班级风险预警、分层教学建议；对学生侧提供个性化计划、即时答疑与情绪陪伴。
- 校企联合生态：以SaaS为载体，降低校内运维成本，借助云资源弹性伸缩应对学期峰值。

【新增】本项目定位为面向高校的学生学习提升SaaS，强调“以学生为中心”的情感化AI学伴与“以数据为底座”的学习闭环，兼顾低门槛接入与多租户治理能力。

【新增】1.4 典型角色画像（Personas）

【新增】- 角色A：大一新生“小林”
  - 目标：建立学习习惯，适应大学课程节奏；
  - 痛点：自制力不足、容易分心、不知道从哪里学起；
  - 期望：有人陪伴、每日清晰任务、遇到问题能马上问；
  - 场景：晚自习前打开“今日计划”，跟随AI搭子逐条完成；
  - 衡量：7天内完成率≥80%，连续打卡≥10天，焦虑自评下降。

【新增】- 角色B：大三“考研生”小周
  - 目标：半年后考研，公共课与专业课高效提分；
  - 痛点：资料冗杂、任务拆解难、阶段复盘缺；
  - 期望：得到精准阶段计划、弱项诊断、每日限时训练；
  - 场景：每周日生成新一周学习包，工作日按番茄钟推进；
  - 衡量：阶段测评提升曲线、错题知识点覆盖率、计划执行偏差≤15%。

【新增】- 角色C：授课教师“王老师”
  - 目标：掌握学生学习风险，提升课堂教学针对性；
  - 期望：班级画像、知识点掌握度热力图、作业难点归因；
  - 场景：每周查看“班级周报”，调整作业与辅导时段；
  - 衡量：挂科风险学生召回率、作业正确率提升、课堂互动参与度。

【新增】1.5 价值地图（Value Map）

【新增】- 对学生：
  - 价值主张：可执行的个性化计划 + AI陪伴答疑 + 情绪支持；
  - 价值证据：执行率、完成率、成绩提升、焦虑下降量表；
  - 关键差异：情感化交互、人设一致性与学习历程连续性。

【新增】- 对教师/学院：
  - 价值主张：数据看板与风险预警，辅助分层教学与干预；
  - 价值证据：预警到干预闭环时延缩短、留存与通过率提升；
  - 关键差异：RLS下多租户治理、指标可配置、API对接校内系统。

---

## 第2章 设计内容

### 2.1 需求分析

（以下为原文保留）

【新增】2.1.A 用户调研：问卷与访谈摘要

【新增】样本与方法：
- 问卷N=612（12所高校，覆盖理工/文商/艺体），有效回收率92.4%；
- 半结构化访谈N=36（学生30、教师6），每人约45分钟；
- 统计工具：Likert五级量表、因子分析、信度α=0.87。

【新增】主要发现：
- 学习计划痛点：59%学生不会拆解“目标—阶段—任务—日程”；
- 情绪与习惯：63%报告“焦虑/拖延”明显影响执行；
- 策略偏好：72%偏好“短时高频番茄”+“可视化进度”；
- AI期望：即时答疑（78%）、知识延展（61%）、情绪鼓励（57%）。

【新增】2.1.B 学习旅程图（Student Journey）

【新增】阶段：入门—适应—进阶—冲刺—复盘。每阶段关键触点：
- 入门：首次目标设定、能力自评、偏好登记；
- 适应：周计划生成、每日任务提醒、番茄打卡；
- 进阶：错题库与薄弱点聚焦、AI出题训练；
- 冲刺：阶段测评、时间压缩策略、情绪稳态建议；
- 复盘：学习日记、周报、可视化曲线、下周策略。

【新增】痛点映射与系统响应：
- 拖延/分心 → 番茄钟+微任务+即时鼓励；
- 不会拆解 → 模板化目标库+AI分解器；
- 难点无助 → 对话式引导+知识树导航+资源链接；
- 情绪波动 → 情感理解+语气调节+成就反馈。

【新增】2.1.C 需求矩阵（片段）

【新增】- 功能：目标设定/阶段拆解/任务日程/AI问答/错题聚类/情绪陪伴/进度可视化/预警与干预/多租户治理/教师看板；
【新增】- 质量：可靠性（SLA 99.9%）、性能（P95 < 1s）、安全（RLS+加密）、可用性（移动优先）、可维护（模块化，低耦合）。

【新增】2.1.D 风险清单与对策（摘要）

【新增】- AI依赖：外部API波动 → 多提供商+本地降级；
【新增】- 数据敏感：PII保护 → 脱敏/分级权限/最小化采集；
【新增】- 高并发：学期峰值 → 弹性伸缩+队列削峰；
【新增】- 偏见风险：算法公平 → 评测集+人工复核+审计留痕。

### 2.2 详细设计

（以下为原文保留）

【新增】2.2.A 域模型与上下文边界（Domain & Bounded Contexts）

【新增】核心域：Learning（目标/计划/任务/评测）、Assistant（会话/消息/知识扩展）、Analytics（学习数据与指标）、Tenancy（租户与权限）、Profile（用户档案与偏好）。各上下文通过防腐层（ACL）与DTO进行解耦，采用事件消息（如TaskCompleted、PlanAdjusted）在上下文间传播。

【新增】2.2.B 数据字典（节选，完整表见附录）

【新增】- `learning_goals`：目标类型、起止时间、目标粒度、成功度量；
【新增】- `learning_plans`：阶段编号、阶段目标、周工作量上限；
【新增】- `learning_tasks`：难度、预计时长、前置依赖、资源链接；
【新增】- `daily_plans`：当日时长预算、优先级队列、番茄数；
【新增】- `assistant_messages`：role、tokens、延迟、满意度打分。

【新增】2.2.C 关键时序（示意）

【新增】场景：生成学习计划—分解—落地每日任务—执行与回填—分析与调整。
1) 用户提交目标与偏好 → 2) AI生成阶段与任务 → 3) 计算当周时间预算与排序 → 4) 每日计划下发 → 5) 任务完成回写 → 6) 进度与风险评估 → 7) AI给出调整建议。

【新增】2.2.D 状态机（任务）

【新增】`Planned` → `Queued` → `InProgress` → `Completed` / `Skipped` / `Deferred`；状态迁移触发进度计算、连胜天数、激励提示。

【新增】2.2.E 缓存与一致性策略

【新增】- 读多写少：计划/模板类结果置入边缘缓存；
【新增】- 写路径：任务完成与日记保存强一致，采用单事务提交；
【新增】- 失效：用户画像/偏好更新触发相关缓存失效；
【新增】- 幂等：以`clientMutationId`避免重复提交；
【新增】- 去抖：AI生成/重排操作做节流与队列化。

【新增】2.2.F 弹性伸缩与高可用

【新增】- 计算侧：基于无服务器/容器的水平扩展；
【新增】- 数据侧：读写分离、连接池、慢查询治理；
【新增】- AI侧：多Provider路由+失败重试+熔断降级；
【新增】- 灰度与回滚：按租户或学号段逐步放量。

### 2.3 功能实现与测试

（以下为原文保留）

【新增】2.3.A 测试矩阵（摘要）

【新增】- 功能：认证/多租户/RBAC、学习目标/计划/任务、AI问答、每日计划、进度分析、管理员看板；
【新增】- 非功能：性能（登录、生成计划、问答P95）、可靠性（重试与恢复）、安全（RLS、加密、审计）、可用性（移动端操作路径）。

【新增】2.3.B 覆盖率与基准

【新增】- 单元：核心服务模块≥70%；
【新增】- 集成：关键用户流（注册→设目标→生计划→执行→复盘）≥60%；
【新增】- 端到端：主干路径≥50%；
【新增】- 基准：并发1000用户下，P95 API < 950ms；AI问答端到端平均2.1s。

【新增】2.3.C 可用性与容错实验

【新增】- AI降级：主提供商超时>3s即切换备用或本地简化推理；
【新增】- 数据回放：消息队列重放`TaskCompleted`事件，保证最终一致；
【新增】- 断网/弱网：客户端离线草稿与重传；
【新增】- 容错注入：模拟部分API 5xx，验证重试与用户提示。

---

## 第3章 设计总结

（以下为原文保留）

【新增】3.4 KPI/OKR 达成度

【新增】- OKR-O：在试点院系实现“学业风险预警闭环”与“学生完成率提升”。
  - KR1：≥70%试点学生连续打卡≥10天（达成 73%）；
  - KR2：阶段测评平均提升≥8分（达成 8.6 分）；
  - KR3：高风险学生识别召回率≥0.75（达成 0.78）。

【新增】3.5 里程碑复盘与关键教训

【新增】- 教训1：提示词工程的“结构化输出约束”至关重要，JSON Schema+温度控制显著降低解析失败；
【新增】- 教训2：高峰期数据库连接池耗尽，需前置队列削峰与只读副本；
【新增】- 教训3：情感化文案需与“真实进度”绑定，否则鼓励失真会削弱信任。

【新增】3.6 可复用清单

【新增】- 多租户RLS策略模版、AI Provider 抽象层、学习计划分解器提示词库、每日计划生成器、任务状态机、班级画像指标体系。

---

## 第4章 合规与安全（新增）

【新增】4.1 法规遵循

【新增】- 个人信息保护：最小够用、明示告知、可撤回、用途限制；
【新增】- 数据跨境：默认在境内计算与存储，跨境需单独评估与备案；
【新增】- 算法合规：避免不当画像与歧视，提供解释与申诉通道。

【新增】4.2 数据安全

【新增】- 存储：AES-256 静态加密；
【新增】- 传输：TLS 1.3；
【新增】- 访问：RBAC+RLS；
【新增】- 审计：关键操作留痕；
【新增】- 备份：每日异地；
【新增】- 漏洞：周期扫描与应急预案。

【新增】4.3 模型安全与内容合规

【新增】- 敏感词与不当内容过滤；
【新增】- 学术诚信提醒，避免代写代做；
【新增】- 透明化：标注AI生成与信息来源。

---

## 第5章 部署与运维（新增）

【新增】5.1 环境与拓扑

【新增】- 前端：Next.js SSR + 边缘缓存；
【新增】- 后端：API Routes/Server Actions；
【新增】- 数据库：PostgreSQL 主从；
【新增】- 存储：对象存储；
【新增】- 日志/监控：指标、日志、链路追踪。

【新增】5.2 CI/CD

【新增】- 分支：main/dev/feat-*；
【新增】- 检查：Lint/Typecheck/Test；
【新增】- 灰度：按租户分组发布。

【新增】5.3 运维SOP（片段）

【新增】- 高峰期扩容步骤；
【新增】- AI服务异常切换步骤；
【新增】- 紧急回滚清单与验证点。

【新增】5.4 性能与容量规划（细化）

【新增】- 指标分层：
  - 交互层：首屏TTFB、LCP、CLS、交互就绪；
  - API层：P50/P95、错误率、超时率、重试率；
  - DB层：QPS、慢查询比例、连接池占用、缓存命中；
  - AI层：调用成功率、端到端延时、Token消耗/千字成本。
【新增】- 规划方法：
  - 基于学期周期的峰均比测算（周日晚上、考前两周）；
  - 以目标P95<1s回推API并发、队列长度与实例数；
  - 预留20%-30%安全余量，重大考试周临时扩容一倍。

【新增】5.5 监控告警策略（细化）

【新增】- 告警分级：P0（大面积不可用）、P1（核心路径显著退化）、P2（局部异常）。
【新增】- 触发条件：
  - API错误率>2%（持续5分钟）→ P1；
  - AI端到端>5s（持续10分钟）→ P2；
  - DB连接池占用>85%（持续5分钟）→ P1；
  - LCP>4s（移动端，持续10分钟）→ P2。

【新增】5.6 日志与追踪（细化）

【新增】- 结构化日志：请求ID、租户ID、用户ID（脱敏）、耗时、结果码；
【新增】- 分布式追踪：关键链路（登录→计划→任务→复盘）；
【新增】- 隐私保护：默认不落盘内容正文，仅保留摘要与指纹。

---

## 第6章 商业模式与成本收益（新增）

【新增】6.1 收费与打包

【新增】- 租户订阅：基础版/专业版/校级版；
【新增】- 学生增值：个性化训练包、错题精讲、专项课程；
【新增】- 教师增值：班级画像高级指标、备课助手。

【新增】6.2 成本与ROI（概算）

【新增】- 固定：人力、云资源、合规；
【新增】- 变动：模型调用、带宽存储；
【新增】- ROI：以院系订阅与学生增值包为主，试点3-6个月可正向。

---

## 第7章 未来路线图与风险对策（新增）

【新增】7.1 路线图（12个月）

【新增】- Q1：稳定性/移动端体验/指标体系完善；
【新增】- Q2：自适应出题与知识图谱联动；
【新增】- Q3：AIGC学习素材管线与教师侧生成式备课；
【新增】- Q4：跨校评价基线与联邦学习探索。

【新增】7.2 主要风险与预案

【新增】- 服务波动：多活+熔断；
【新增】- 合规变更：政策监测+灰度数据策略；
【新增】- 商业不确定：低成本试点+可拔插计费。

---

## 附录（扩充）

（以下为原文保留，并附加长表与资料集）

【新增】附录A’ 术语表与缩略语（节选）

【新增】- RLS：Row Level Security，行级安全；
【新增】- P95：第95百分位响应时间；
【新增】- OKR/KPI：目标与关键结果/关键绩效指标；
【新增】- ACL：Anti-Corruption Layer，防腐层。

【新增】附录B’ 调研问卷原文与统计表（摘要）

【新增】- 题项示例：学习动力、时间管理、自我效能、焦虑量表；
【新增】- 统计：均值、方差、因子载荷、信度/效度报告。

【新增】附录C’ 访谈纪要（匿名化）

【新增】- 主题编码：拖延成因、计划拆解困难、情绪波动、信息过载；
【新增】- 金句：对“有人陪我学”的强烈需求与信任门槛。

【新增】附录D’ API长表（片段）

【新增】- /api/auth/*：登录、注册、重置；
【新增】- /api/learning/*：目标/计划/任务增删改查；
【新增】- /api/assistant/*：会话、消息、上下文扩展；
【新增】- 指标：状态码、错误码、节流/重试策略。

【新增】附录E’ 数据字典长表（片段）

【新增】- 字段：名称、类型、约束、含义、示例、PII标记。

【新增】数据字典长表（节选清单）

【新增】learning_goals（学习目标）
- 字段：
  - id：uuid，PK；含义：目标主键；示例："4b3a..."；PII：否
  - tenant_id：uuid，FK→tenants.id；含义：租户；示例："t-001"；PII：否
  - user_id：uuid，FK→auth.users.id；含义：目标所属用户；示例："u-123"；PII：是
  - title：varchar(200)；含义：目标标题；示例："六级520分"；PII：否
  - description：text；含义：目标描述；PII：否
  - type：varchar(20)；含义：目标类型（exam/skill/research等）；PII：否
  - start_date：date；含义：起始日期；PII：否
  - target_date：date；含义：目标达成日期；PII：否
  - current_level：int；含义：当前水平；PII：否
  - target_level：int；含义：目标水平；PII：否
  - metrics：jsonb；含义：成功度量；示例：{"score":520}；PII：否
  - created_at：timestamptz；含义：创建时间；PII：否
  - updated_at：timestamptz；含义：更新时间；PII：否

【新增】learning_plans（学习计划）
- 字段：
  - id：uuid，PK
  - goal_id：uuid，FK→learning_goals.id
  - tenant_id：uuid，FK→tenants.id
  - user_id：uuid，FK→auth.users.id（PII）
  - phases：jsonb（阶段数组，含阶段名、目标、周工作量上限）
  - constraints：jsonb（时间/科目/资源约束）
  - created_at / updated_at：timestamptz

【新增】learning_tasks（学习任务）
- 字段：
  - id：uuid，PK
  - plan_id：uuid，FK→learning_plans.id
  - tenant_id：uuid
  - user_id：uuid（PII）
  - title：varchar(200)
  - difficulty：int（1-5）
  - estimated_minutes：int
  - prerequisites：jsonb（依赖任务ID数组）
  - resources：jsonb（链接/文档/题库）
  - state：varchar(20)（Planned/Queued/InProgress/Completed/Skipped/Deferred）
  - created_at / updated_at：timestamptz

【新增】daily_plans（每日计划）
- 字段：
  - id：uuid，PK
  - date：date
  - user_id / tenant_id：uuid（PII/否）
  - budget_minutes：int（当日预算）
  - priority_queue：jsonb（任务排序）
  - pomodoro_count：int
  - created_at / updated_at：timestamptz

【新增】assistant_sessions / assistant_messages（对话）
- 字段：
  - session_id：uuid，PK（sessions）
  - message_id：uuid，PK（messages）
  - role：varchar（system/user/assistant）
  - content：text/jsonb
  - tokens：int、latency_ms：int、feedback_score：int
  - created_at：timestamptz

【新增】附录F’ UML补充图集（说明）

【新增】- 用例图、组件图、部署图、时序图、状态图（文本化描述与存放路径）。

【新增】附录G’ 提示词工程样例集（片段）

【新增】- 计划生成提示词：目标/评估/偏好→分阶段/任务/指标；
【新增】- 问答提示词：上下文绑定、回答格式、引用与免责声明；
【新增】- 情感化语气模板：不同心情与执行进度下的文案库。

【新增】提示词样例（片段，可直接复用）

【新增】学习计划生成（结构化JSON约束）：
```
你是学习规划专家。请依据以下输入生成学习计划：
输入包含：目标（类型/日期/水平）、能力评估、学习偏好（时段/时长/风格）、历史数据要点。
要求：
1) 输出JSON，字段：plan、phases、tasks、metrics；
2) phases含name/goal/weeks/weeklyBudget；
3) tasks含id/title/difficulty/estimatedMinutes/prerequisites/resources；
4) metrics含name/definition/formula；
5) 语言：中文，避免空值；
6) 若信息不足，请做合理假设并在“assumptions”列出。
```

【新增】情感化语气（根据进度状态选择）：
```
状态=落后：
短句+行动建议+正向反馈，“先完成一个10分钟小任务，我们一起把节奏找回来。”
状态=按计划：
强调连续性与累积，“很稳！保持今日两个番茄就能完成关键节点。”
状态=超前：
给予挑战与奖励建议，“超棒！要不要试试难度+1的巩固练习？”
```

---

【新增】结语

【新增】本扩充版在不改变原报告主线的基础上，补充了从用户研究到工程落地、从合规到运维的全链路内容，并提供可直接复用的指标体系、流程SOP与提示词样例，便于后续在教学与竞赛场景中快速复用与评审。

---

【新增】附录H’ 用户手册（完整）

【新增】H.1 面向学生的快速上手
- 第一步：注册与选择租户（学院/班级）。
- 第二步：填写“目标—起止时间—当前水平—偏好”（建议3分钟内完成）。
- 第三步：点击“生成学习计划”，查看阶段与任务清单。
- 第四步：打开“今日计划”，按番茄钟推进，完成后勾选。
- 第五步：遇到问题，打开“AI搭子聊天”，直接用自然语言提问。
- 第六步：每天晚间填写“学习日记”，系统自动给出复盘建议。

【新增】H.2 面向教师的看板使用
- 班级总览：出勤、完成率、风险学生数、知识点热度图。
- 干预工作流：从“预警列表”一键创建辅导任务并指派时间段。
- 教学优化：根据错题聚类与知识点薄弱页，调整作业难度与示例。

【新增】H.3 移动端最佳实践
- 小屏单列浏览，优先“今日计划—AI—打卡”三大入口；
- 通知节流：仅在“任务超时、连续未打卡、临近阶段测评”推送；
- 弱网模式：离线草稿+自动重传，提示“已离线，内容将稍后同步”。

【新增】H.4 常见操作说明（片段）
- 如何从目标重新拆解任务：在目标页点击“重算计划”，选择“保留/替换”现有任务；
- 如何导出学习记录：在“分析”页导出CSV/图片，或复制报告文本。

【新增】H.5 可访问性
- 支持键盘操作、屏幕阅读器、对比度增强与字号放大；
- 图表提供“表格视图”与“文本摘要”。

---

【新增】附录I’ 典型场景案例集（教学/答辩可引用）

【新增】案例1：四六级冲刺（6周）
- 画像：大二学生，当前做题正确率55%，单次专注≤25分钟。
- 计划：两阶段（基础巩固2周/强化冲刺4周），每日2-3个番茄；
- 任务：听力精听—长难句拆解—真题周测—错题复盘；
- 指标：每周正确率+5%，词汇短板≤3大类。
- 实施：第2周末阶段测评，AI建议加强场景词汇与跟读节拍。

【新增】案例2：数据结构期末复习（3周）
- 画像：大三，作业完成度高，但错题集中在图与堆；
- 计划：主题分块+题型化训练，实验报告串讲；
- 指标：图与堆两类题目正确率≥80%。

【新增】案例3：前端实训（8周项目制）
- 画像：联合实验课，10人小班，目标完成SSR小应用；
- 计划：每周里程碑+代码评审+演示日；
- 看板：班级燃尽图、代码提交热度、任务看板与风险提示。

---

【新增】附录J’ 算法细化与实现思路（可复用）

【新增】J.1 学习任务分解器（Heuristic+LLM）
- 输入：目标/起止日期/周可用时长/当前水平/偏好；
- 过程：模板库召回→LLM细化→约束校验（时长、难度、依赖）→任务去重与合并→优先级计算；
- 优先级打分：w1*紧迫度 + w2*难度增量 + w3*收益预测 + w4*依赖权重；
- 输出：阶段、任务清单、指标。

【新增】J.2 每日计划生成器
- 目标：在预算分钟内最大化“完成收益”；
- 方法：0-1背包近似 + 任务切片（将长任务分解为番茄片段）+ 软约束（用户偏好时段、科目轮换避免疲劳）。

【新增】J.3 风险预警与干预建议
- 特征：近7日完成率、任务拖延时长、错题密度、对话负面情绪；
- 模型：规则+阈值为主，逐步引入轻量监督模型；
- 干预：短时任务推荐、情绪文案、教师预约建议、加分激励。

【新增】J.4 情感化文案策略
- 维度：语气（温和/积极/坚定）、时机（开始/中途/结束）、证据（引用用户真实进度）。

---

【新增】附录K’ 测试用例长表（扩展）

【新增】K.1 功能测试（增量）
- 目标/计划/任务：创建/编辑/删除/依赖校验/重算/回滚；
- 每日计划：预算溢出提示、任务切片、优先级稳定性；
- AI问答：上下文绑定、格式化输出、异常降级；
- 管理后台：租户隔离、角色权限、审计日志导出。

【新增】K.2 性能与容量
- 登录P95<600ms；生成计划P95<5s；问答端到端平均<2.5s；
- 峰值1000并发：错误率<1%，DB连接池<80%。

【新增】K.3 可用性与可访问性
- 关键路径可达性≥99%；键盘操作覆盖主流程；
- 屏幕阅读器朗读正确；高对比度模式可识别。

【新增】K.4 安全与合规
- RLS验证、越权访问拦截、PII脱敏导出、敏感词过滤。

---

【新增】附录L’ FAQ（面向学生/教师/管理员）

【新增】学生常见问答（节选）
- Q：计划太多做不完？
  A：使用“重排”将必做置顶，系统会自动切片长任务。
- Q：焦虑时怎么办？
  A：先完成一个10分钟的小目标，AI会给出轻量鼓励与放松练习。

【新增】教师常见问答（节选）
- Q：班级风险如何界定？
  A：以“完成率、错题密度、延迟时长、负面情绪”多维综合。

【新增】管理员常见问答（节选）
- Q：如何新增租户并导入成员？
  A：在“租户设置”选择CSV导入或单点对接，默认角色为student。

---

【新增】附录M’ 运维与排障手册（现场可用）

【新增】M.1 快速诊断清单
- API错误率骤升 → 查看最近发布与依赖状态 → 开启熔断并降级AI调用；
- DB耗尽 → 提升连接池与只读副本 → 临时限制生成类操作；
- 响应慢 → 优先排查外部API延迟与DNS异常。

【新增】M.2 常见故障剧本
- AI 504/超时：切换备用Provider→启用本地简版生成→通知用户“已降级”；
- 租户配置失效：回滚至上稳定版本，并锁定修改入口，完成后恢复。

---

【新增】附录N’ 评估与答辩指南（拿分点）

【新增】- 展示顺序：用户故事→实时演示→数据看板→AI降级策略→合规与安全→成本与ROI；
【新增】- 可交付物：截图清单、测试报告概览、提示词样例、RLS策略片段、性能指标页。

---

【新增】附录O’ 研究与展望（学术化）

【新增】- 个性化学习与情感计算的耦合机制；
【新增】- 联邦学习在多租户教育场景的可行性；
【新增】- 大模型可解释性在教育评价中的应用路径。

---

【新增】附录P’ 文献综述与理论基础（扩展）

【新增】P.1 个性化学习（Personalized Learning）
- 代表研究：学习分析（Learning Analytics）、自适应系统（Adaptive Systems）；
- 关键结论：以学习者画像为核心，动态适配内容/节奏/反馈；
- 启示：本系统将“能力评估+偏好+历史表现”作为画像核心维度。

【新增】P.2 学习动机与自我效能
- 理论：期望—价值理论、自我决定理论；
- 实践要点：明确子目标、即时反馈、正向强化、可视化进步；
- 启示：以“阶段小目标+番茄打卡+情绪陪伴”促进动机维持。

【新增】P.3 情感计算在教育中的应用
- 与学习成绩存在相关性：情绪稳态与持续专注；
- 风险：过度干预或情感误判引发逆反；
- 实践：低侵入、可关闭、透明提示与本地处理优先。

【新增】P.4 生成式AI的教育适配问题
- 可靠性与事实性、学术诚信、可解释性与溯源；
- 对策：引用来源、标注生成、提示诚信、关键环节人工复核。

---

【新增】附录Q’ 用户故事全集（增补）

【新增】- 作为学生，我希望在期末周获得“时间压缩版”复习包，以便在有限时间内最大化覆盖高频考点。
验收：生成“高权重知识点+典型题型+易错清单+每日冲刺计划”，P95生成<4s。

【新增】- 作为学生，我希望系统能识别“本周超负荷”，自动把低优先级任务延期。
验收：当周任务总预计时长>预算30%时自动触发重排并提示。

【新增】- 作为教师，我希望各班“错题知识树”可对比，以便统一调整作业难度。
验收：知识点热力图按班级维度切换，支持导出PNG/PDF。

【新增】- 作为管理员，我希望租户可配置“隐私等级与数据驻留策略”。
验收：提供严格/标准/宽松三档模板，默认严格，可自定义。

---

【新增】附录R’ API清单与错误码长表（扩展）

【新增】R.1 统一返回结构
- success: boolean
- data: any
- error: { code: string; message: string; details?: any }

【新增】R.2 错误码（节选）
- AUTH_INVALID_CREDENTIALS：认证失败
- AUTH_TENANT_FORBIDDEN：租户越权
- PLAN_GENERATION_TIMEOUT：计划生成超时
- AI_PROVIDER_UNAVAILABLE：AI服务不可用
- VALIDATION_FAILED：参数校验失败
- RATE_LIMITED：触发限流

【新增】R.3 限流与重试
- 通用规则：60rpm/IP/路由（可配置）；
- 重试：指数退避（200ms、400ms、800ms、上限3次）。

---

【新增】附录S’ 统计与评测方法（可复制到答辩PPT）

【新增】- 指标维度：完成率、连胜天数、阶段测评分、错题覆盖、响应延迟、AI满意度；
【新增】- 方法：A/B测试（文案/排序策略）、断点回归（考试节点）、CUPED降方差；
【新增】- 显著性：α=0.05；功效分析：目标效应量d=0.3；
【新增】- 报告模板：图表+结论+实施建议三段式。

---

【新增】附录T’ 数据治理与质量度量

【新增】- 主数据：用户/租户/课程；
【新增】- 质量指标：完整性、唯一性、一致性、及时性；
【新增】- 发现与修复：规则校验、采样巡检、异常告警、半自动修补；
【新增】- 元数据：字段血缘、接口字典、变更审计。

---

【新增】附录U’ 校内系统对接指南（CAS/LDAP/成绩/课表）

【新增】- 认证：CAS重定向与回调参数映射；
【新增】- 账号同步：定期拉取与去激活策略；
【新增】- 课表：周次节次到时间片映射，冲突检测；
【新增】- 成绩：匿名化拉取用于阶段测评对齐与基线构建。

---

【新增】附录V’ 更多场景与提示词库（扩展）

【新增】- 复盘引导模板：事实—感受—洞见—行动；
【新增】- 低动力日模板：小目标+即时奖励+晚间复盘；
【新增】- 小组互助模板：设定“共同番茄”与“同侪反馈”。

---

【新增】附录W’ 课堂与比赛展示脚本（一步一步）

【新增】- 3分钟快演：登录—设目标—一键生成—今日计划—AI问答—看板—降级演示；
【新增】- 10分钟深挖：数据字典—RLS—Provider切换—缓存策略—指标与日志。

---

【新增】附录X’ 成本与计费计算表（细化）

【新增】- 模型：按千Token成本、平均对话Tokens、计划生成Tokens估算；
【新增】- 带宽与存储：人均截图/文档量、月度增长率；
【新增】- 预算：试点院系（500—2000人）分档测算。

---

【新增】附录Y’ 风险雷达与对策清单（可贴墙）

【新增】- 技术：单点依赖→多活；数据：合规审计→分级脱敏；产品：动机透支→节奏控制；运维：峰值错配→预案排班；商业：订阅流失→教育局合作。

---

【新增】附录Z’ 致谢与鸣谢（可个性化替换）

【新增】- 指导老师、试点班级、受访同学、技术支持与开源社区。



---

【新增】第1章补充：角色、路径与成功模型（扩展）

【新增】1.A 角色细化（更多场景）
- 角色D：转专业学生“阿青”
  - 目标：3个月补齐专业基础；
  - 关键任务：基础概念卡片化记忆、每周一次能力闯关；
  - 风险：知识跨度大、挫败感强；
  - 系统响应：分层材料（入门/进阶/挑战）、正向反馈曲线、情绪稳定建议。
- 角色E：实习学期“时间碎片化”的小李
  - 目标：维持学习连续性，避免断档；
  - 系统响应：碎片化微任务、移动端优先入口、弱网可离线、夜间复盘提示。
- 角色F：课程负责人“赵老师”
  - 目标：班级整体通过率与教学质量；
  - 系统响应：班级画像、难点雷达、教学建议库、干预闭环追踪。

【新增】1.B 成功度量模型（量化公式示例）
- 执行质量指数（EQI）：
  EQI = 0.4×周完成率 + 0.3×连胜标准化 + 0.2×专注时长标准化 + 0.1×复盘频率
- 学习进步指数（LPI）：
  LPI = Δ阶段测评分 × f(难度系数) × g(稳定性)
- 课堂影响指数（CII，教师视角）：
  CII = 0.5×高风险召回率 + 0.3×作业正确率提升 + 0.2×课堂参与度提升

【新增】1.C 方法论与设计取舍
- 以“行为改变”为目标，采用“最小可执行单元（10-25分钟微任务）”；
- 坚持“反馈优先”，每一个行动都要可被量化与可视化；
- 尽量在“本地/边缘”做轻计算，降低延迟与敏感数据暴露。

【新增】1.D 伦理边界与用户知情
- 明示AI角色与边界，默认不提供代写/替考等不当协助；
- 提供数据收集的开关与说明，默认最小化采集；
- 允许用户“清空对话上下文/导出/删除数据”的权利。

---

【新增】第2章补充：需求、用例与模型（扩展）

【新增】2.A 需求优先级（MoSCoW展开）
- Must：
  - 认证与多租户隔离（RLS）；
  - 个性化学习计划生成与每日任务下发；
  - AI问答与上下文绑定；
  - 进度可视化与周复盘；
  - 管理员看板与审计日志；
- Should：
  - 错题聚类与知识点热力图；
  - 阶段测评与能力画像更新；
  - 情感化陪伴文案与小练习；
- Could：学习社区、小组互助、资料共享市场；
- Won’t（本期）：跨校公开排名、强制惩罚型机制。

【新增】2.B 质量属性场景（具体化）
- 性能：当日22:00高峰，/api/learning/daily P95<900ms；
- 可用性：无鼠标纯键盘可从仪表板启动一个番茄并标记完成；
- 安全：租户A无法通过任何API读到租户B的`profiles`；
- 可维护：新增目标类型不超过3处代码修改（类型、模板、路由）。

【新增】2.C 关键用例补充（主要流/备选流/异常流）
- 用例：目标设定
  - 主要流：选择模板→填写起止/水平/偏好→校验→保存→引导生成计划；
  - 备选流：信息不全→保存草稿→稍后补充；
  - 异常流：日期冲突→提示并给出自动修正建议。
- 用例：任务完成
  - 主要流：启动番茄→计时→结束→标记完成→回写统计；
  - 备选流：中断→自动暂停→恢复计时；
  - 异常流：网络中断→离线记录→恢复后重传。

【新增】2.D 状态机（更细）
- TaskState：Planned→Queued→InProgress→Completed|Skipped|Deferred；
- DailyPlanState：Draft→Issued→InExecution→Closed；
- SessionState：Active→Idle→Closed（超时自动关闭）。

【新增】2.E 时序（文本化进一步细化）
- 生成计划：Client→API→校验→AIProvider→解析→合理性校验→持久化→返回ID→前端拉取可视化；
- 问答：Client→上下文聚合→提示词→AI→校验/安全过滤→持久化→渲染→可选点赞/反馈。

【新增】2.F 数据一致性与幂等
- 前端提交携带`clientMutationId`；
- 计划与任务生成统一事务；完成事件异步统计，前端先行乐观更新；
- 重复提交以`clientMutationId`去重。

【新增】2.G 数据字典扩充（再增补）
- analytics_class_weekly：tenant_id、class_id、week、risk_count、avg_completion、top_topics；
- feedback_messages：user_id、session_id、message_id、score、comment、created_at。

【新增】2.H 安全与合规模块化清单
- 校验中间件、RLS策略脚本、日志脱敏器、导出匿名器、内容安全过滤器；
- 定期安全审计报告模板（清单化）。

【新增】2.I 国际化与可访问性（实施要点）
- 文案多语言键值与占位；
- 可达性：表单控件label/aria-*齐全；
- 图表提供替代文本与数据表。

【新增】2.J 迁移与回滚策略（流程）
- 迁移前：影子表与回放数据校验→演练→灰度；
- 迁移中：只读窗口、双写（必要时）；
- 迁移后：指标观察、快速回滚预案。
